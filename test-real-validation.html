<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üß™ CRITICAL TEST - Empty Social Links Validation</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 1000px; margin: 0 auto; padding: 20px; }
        .test-container { background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input, textarea { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; box-sizing: border-box; }
        button { background: #dc3545; color: white; padding: 12px 24px; border: none; border-radius: 5px; cursor: pointer; margin: 5px; }
        button:hover { background: #c82333; }
        .result { margin-top: 20px; padding: 15px; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .warning { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
        .social-section { background: #e9ecef; padding: 15px; border-radius: 5px; margin: 10px 0; }
        .social-input { margin-bottom: 10px; }
        .empty-indicator { color: #6c757d; font-style: italic; }
        pre { background: #f1f1f1; padding: 10px; border-radius: 5px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>üö® CRITICAL TEST: Empty Social Links Validation</h1>
    <p><strong>PURPOSE:</strong> Test if the "Missing required fields" error still appears when social links are empty.</p>
    
    <div class="test-container">
        <h2>TEST SCENARIO: Token with NO Social Links</h2>
        
        <div class="form-group">
            <label>Token Name *</label>
            <input type="text" id="tokenName" value="CriticalTest" required>
        </div>
        
        <div class="form-group">
            <label>Token Symbol *</label>
            <input type="text" id="tokenSymbol" value="CTEST" required>
        </div>
        
        <div class="form-group">
            <label>Supply *</label>
            <input type="number" id="tokenSupply" value="1000000" required>
        </div>
        
        <div class="form-group">
            <label>Decimals *</label>
            <input type="number" id="tokenDecimals" value="9" required>
        </div>
        
        <div class="social-section">
            <h3>Social Links (ALL LEFT EMPTY)</h3>
            <div class="social-input">
                <label>Twitter <span class="empty-indicator">(EMPTY)</span></label>
                <input type="text" id="socialTwitter" placeholder="INTENTIONALLY LEFT EMPTY">
            </div>
            <div class="social-input">
                <label>Discord <span class="empty-indicator">(EMPTY)</span></label>
                <input type="text" id="socialDiscord" placeholder="INTENTIONALLY LEFT EMPTY">
            </div>
            <div class="social-input">
                <label>Instagram <span class="empty-indicator">(EMPTY)</span></label>
                <input type="text" id="socialInstagram" placeholder="INTENTIONALLY LEFT EMPTY">
            </div>
            <div class="social-input">
                <label>YouTube <span class="empty-indicator">(EMPTY)</span></label>
                <input type="text" id="socialYoutube" placeholder="INTENTIONALLY LEFT EMPTY">
            </div>
        </div>
        
        <button onclick="testValidation()">üß™ TEST VALIDATION (Critical Test)</button>
        <button onclick="testManualPreview()">üîç Test Manual Preview Function</button>
        <button onclick="clearResults()">üóëÔ∏è Clear Results</button>
        
        <div id="testResults"></div>
    </div>
    
    <script>
        // Copy EXACT validateMetadata function from main app
        function validateMetadata(data) {
            const required = ["name", "symbol", "supply", "decimals"];
            for (const field of required) {
                if (!data[field]) {
                    throw new Error(`Missing required field: ${field}`);
                }
            }
            if (!data.image && !data.metadataUri) {
                throw new Error("Either image or metadataUri must be provided.");
            }
        }
        
        // Copy EXACT previewManualToken function from main app
        function previewManualToken() {
            // Validate required fields
            const name = document.getElementById('tokenName').value;
            const symbol = document.getElementById('tokenSymbol').value;
            const description = 'Test token with no social links';
            
            if (!name || !symbol || !description) {
                alert('Please fill in all required fields (Name, Symbol, Description)');
                return;
            }
            
            // Create preview data
            const tokenData = {
                name,
                symbol,
                description,
                supply: document.getElementById('tokenSupply').value,
                decimals: document.getElementById('tokenDecimals').value,
                revokeMint: false,
                revokeFreeze: false,
                revokeUpdate: false,
                image: 'test-image-placeholder',
                socialLinks: {
                    twitter: document.getElementById('socialTwitter').value,
                    telegram: '',
                    discord: document.getElementById('socialDiscord').value,
                    instagram: document.getElementById('socialInstagram').value,
                    tiktok: '',
                    youtube: document.getElementById('socialYoutube').value,
                    website: ''
                }
            };
            
            return tokenData;
        }
        
        function testValidation() {
            const resultDiv = document.getElementById('testResults');
            
            // Create token data with empty social links
            const tokenData = {
                name: document.getElementById('tokenName').value,
                symbol: document.getElementById('tokenSymbol').value,
                supply: document.getElementById('tokenSupply').value,
                decimals: document.getElementById('tokenDecimals').value,
                image: 'test-image-url', // Required field satisfied
                // Social links intentionally empty/undefined
                socialLinks: {
                    twitter: document.getElementById('socialTwitter').value || '',
                    discord: document.getElementById('socialDiscord').value || '',
                    instagram: document.getElementById('socialInstagram').value || '',
                    youtube: document.getElementById('socialYoutube').value || ''
                }
            };
            
            let testResults = [];
            
            // TEST 1: Direct validateMetadata() test
            try {
                validateMetadata(tokenData);
                testResults.push({
                    test: 'validateMetadata() Direct Test',
                    status: 'PASS',
                    message: 'Validation passed with empty social links!'
                });
            } catch (error) {
                testResults.push({
                    test: 'validateMetadata() Direct Test',
                    status: 'FAIL',
                    message: `ERROR: ${error.message}`
                });
            }
            
            // TEST 2: Manual preview simulation
            try {
                const previewData = previewManualToken();
                testResults.push({
                    test: 'Manual Preview Simulation',
                    status: 'PASS',
                    message: 'Manual preview worked with empty socials!'
                });
            } catch (error) {
                testResults.push({
                    test: 'Manual Preview Simulation',
                    status: 'FAIL',
                    message: `ERROR: ${error.message}`
                });
            }
            
            // Display results
            let resultHTML = '<h3>üß™ TEST RESULTS</h3>';
            let overallStatus = 'PASS';
            
            testResults.forEach(result => {
                const className = result.status === 'PASS' ? 'success' : 'error';
                if (result.status === 'FAIL') overallStatus = 'FAIL';
                
                resultHTML += `
                    <div class="result ${className}">
                        <strong>${result.test}: ${result.status}</strong><br>
                        ${result.message}
                    </div>
                `;
            });
            
            // Overall assessment
            const overallClass = overallStatus === 'PASS' ? 'success' : 'error';
            const overallMessage = overallStatus === 'PASS' 
                ? '‚úÖ ALL TESTS PASSED - Social links validation is FIXED!'
                : '‚ùå TESTS FAILED - Social links validation is STILL BROKEN!';
                
            resultHTML += `
                <div class="result ${overallClass}" style="margin-top: 20px; font-size: 1.2em;">
                    <strong>OVERALL RESULT: ${overallMessage}</strong>
                </div>
            `;
            
            // Show token data for debugging
            resultHTML += `
                <div class="result warning">
                    <strong>Token Data Used in Test:</strong>
                    <pre>${JSON.stringify(tokenData, null, 2)}</pre>
                </div>
            `;
            
            resultDiv.innerHTML = resultHTML;
        }
        
        function testManualPreview() {
            const resultDiv = document.getElementById('testResults');
            
            try {
                const previewData = previewManualToken();
                resultDiv.innerHTML = `
                    <div class="result success">
                        <h3>‚úÖ Manual Preview Test PASSED</h3>
                        <p>The previewManualToken() function worked successfully with empty social links!</p>
                        <strong>Preview Data:</strong>
                        <pre>${JSON.stringify(previewData, null, 2)}</pre>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="result error">
                        <h3>‚ùå Manual Preview Test FAILED</h3>
                        <p><strong>Error:</strong> ${error.message}</p>
                        <p>This indicates the manual preview function is still enforcing social validation!</p>
                    </div>
                `;
            }
        }
        
        function clearResults() {
            document.getElementById('testResults').innerHTML = '';
        }
        
        // Auto-clear social inputs to ensure they're empty
        window.onload = function() {
            document.getElementById('socialTwitter').value = '';
            document.getElementById('socialDiscord').value = '';
            document.getElementById('socialInstagram').value = '';
            document.getElementById('socialYoutube').value = '';
        };
    </script>
</body>
</html>